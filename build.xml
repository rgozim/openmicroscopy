<?xml version="1.0" encoding="utf-8"?>
<project name="services" default="install" basedir=".">

    <property name="import.dir" value="${basedir}/../antlib/resources"/>
    <import file="${import.dir}/global.xml"/>
    <import file="${import.dir}/dependencies.xml"/>
    <import file="${import.dir}/lifecycle.xml"/>
    <import file="${import.dir}/hibernate.xml"/>

    <target name="check-db" depends="prepare">
      <sql_run>
	<transaction> select 'database exists.' </transaction>
      </sql_run>
    </target>

    <target name="reload-db" depends="prepare,setup-db"/>

    <target name="compile" depends="generate">
        <hardWireCompile pattern="ome/services/util/OmeroAroundInvoke"
            token="&quot;ome.security.basic.BasicSecurityWiring&quot;"/>

    </target>

   <target name="initdb" depends="compile">
        <taskdef classname="ome.tools.DbUpdateTask" classpathref="omero.classpath" name="dbUpdate"/>
        <dbUpdate sqldir="${sql.dir}" classpathref="omero.classpath"
            driver="${hibernate.connection.driver_class}"
            url="${hibernate.connection.url}"
            userid="${hibernate.connection.username}"
            password="${hibernate.connection.password}" 
         />
    </target>

</project>
