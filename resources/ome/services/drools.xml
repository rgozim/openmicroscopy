<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">
<!--
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# 
# $Id$
# 
# Copyright 2006 University of Dundee. All rights reserved.
# Use is subject to license terms supplied in LICENSE.txt
#
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-->

<!--
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Written by:  Josh Moore <josh.moore@gmx.de>
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-->

<!--

	Configuration of rules engine
 
-->

<beans>	

    <bean id="ruleSetTemplate" abstract="true"
        class="org.drools.spring.factory.RuleSetFactoryBean">
        <property name="ruleMetadataSourceChain">
            <list>
                <bean class="org.drools.spring.metadata.annotation.java.AnnotationRuleMetadataSource"/>
                <bean class="org.drools.spring.metadata.ClassInferedRuleMetadataSource"/>
            </list>
        </property>
        <property name="methodMetadataSourceChain">
            <bean class="org.drools.spring.metadata.annotation.java.AnnotationMethodMetadataSource"/>
        </property>
        <property name="argumentMetadataSourceChain">
            <list>
                <bean class="org.drools.spring.metadata.annotation.java.AnnotationArgumentMetadataSource"/>
                <bean class="org.drools.spring.metadata.ParameterInferedTypeArgumentMetadataSource"/>
            </list>
        </property>
    </bean>    

    <bean id="ruleTemplate" abstract="true">
<!--    <property name="control" ref="tempuratureControl"/> -->
    </bean>
    
    <bean id="ruleSet" parent="ruleSetTemplate">
        <property name="rules">
            <set>
<!-- FOR DEBUGGING ONLY
	                <bean id="all" parent="ruleTemplate" 
                    class="ome.rules.drools.AllObjects" />
-->
                <bean id="time" parent="ruleTemplate" 
                    class="ome.rules.drools.TimeRule" />
				<bean id="graph" parent="ruleTemplate" 
                    class="ome.rules.drools.GraphRule" />
				<bean id="classification" parent="ruleTemplate" 
                    class="ome.rules.drools.ClassificationExclusivityRule" />
				</set>
        </property>
    </bean>

	<bean id="conflictResolver"
		class="org.drools.spring.factory.ConflictResolverFactoryBean">
		<property name="resolverStrategies">
			<list>
				<bean class="org.drools.conflict.SalienceConflictResolver" />
				<bean class="org.drools.conflict.LoadOrderConflictResolver" />
			</list>
		</property>
	</bean>

    <bean id="ruleBase"
        class="org.drools.spring.factory.RuleBaseFactoryBean">
        <property name="conflictResolver" ref="conflictResolver" />
        <property name="autoDetectRuleSets" value="true"/>
    </bean>

	<!-- CURRENTLY UNUSED
    <bean id="workingMemory"
        class="org.drools.spring.factory.WorkingMemoryFactoryBean">
        <property name="ruleBase" ref="ruleBase" />
        <property name="autoDetectListeners" value="false"/>
    </bean>

    <bean id="workingMemoryLogger"
        class="org.drools.event.DebugWorkingMemoryEventListener">
    </bean>
	-->

	<bean id="rulesEngine" class="ome.rules.DroolsEngine">
		<constructor-arg index="0" ref="ruleBase" />
		<constructor-arg index="1" value="true" />		
	</bean>
    
</beans>
